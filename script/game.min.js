function jump(a,b){var c=a.player,d=c.col,e=c.row,f=0;switch(b){case"left":e--,f=100;break;case"right":e++,f=50;break;case"up":d--,f=50;break;case"down":d++,f=100}var g=d+"_"+e;c.jump<2&&a.surface[g]&&(c.jump++,c.jump>1&&c.move_x&&c.move_y&&(c.move_x.stop(),c.move_y.stop(),f+=20),x=a.surface[g].x,y=a.surface[g].y,a.cursor.x=x-40,a.cursor.y=y-19,a.cursor.visible=!0,move_x=a.add.tween(c).to({x:x-40},500,Phaser.Easing.Linear.None).start(),move_y=a.add.tween(c).to({y:y-f-63},250,Phaser.Easing.Cubic.Out).to({y:y-63},250,Phaser.Easing.Cubic.In).start(),c.col=d,c.row=e,c.move_y=move_y,c.move_x=move_x,move_x.onComplete.add(function(){a.surface[g].available||death(a),a.player_location=d+"_"+e,a.cursor.visible=!1,c.jump=0},c))}function death(a){a.player_location=null,a.keyboard=!1,a.add.tween(a.player).to({alpha:1},200,Phaser.Easing.Linear.None).to({alpha:0},800,Phaser.Easing.Linear.None).start();var b=a.add.tween(a.player).to({y:a.player.y-40},1e3,Phaser.Easing.Linear.None).to({y:a.player.y-20},1e3,Phaser.Easing.Linear.None).start();b.onComplete.add(function(){a.game.state.start("menu")})}function draw_surface(a){a.surface_group=a.add.group();var b,c,d,e,f,g;for(b=0;b<=a.data.surface.col+1;b++)for(c=0;c<=a.data.surface.row+1;c++)d=85*b+85*c,e=43*b-43*c,f=b+"_"+c,a.surface[f]={link:f,sprite:null,x:d,y:e,available:!1,visible:!1},a.data.lands.hasOwnProperty(f)&&(g=a.add.sprite(d-85,e-43,a.data.lands[f]),a.surface[f].sprite=g,a.surface[f].available=!0,a.surface[f].visible=!0,a.surface_group.add(g));a.surface_group.sort("y",Phaser.Group.SORT_ASCENDING),a.universe.add(a.surface_group)}function draw_cursor(a){var b=a.data.player.spawn.col+"_"+a.data.player.spawn.row;a.cursor=a.add.sprite(a.surface[b].x-40,a.surface[b].y-19,"cursor"),a.cursor.visible=!1,a.universe.add(a.cursor)}function draw_player(a){var b=a.data.player.spawn.col+"_"+a.data.player.spawn.row;a.player_location=b,a.player=a.add.sprite(a.surface[b].x-40,a.surface[b].y-63,"player"),a.player.col=a.data.player.spawn.col,a.player.row=a.data.player.spawn.row,a.player.jump=0,a.player.move_x=null,a.player.move_y=null,a.universe.add(a.player)}var preload=function(a){};preload.prototype={init:function(){this.game.scale.scaleMode=Phaser.ScaleManager.EXACT_FIT},preload:function(){this.load.json("data","data.json"),this.load.image("cursor","images/cursor.png"),this.load.image("land","images/land.png"),this.load.image("player","images/player.png"),this.load.image("target","images/target.png")},create:function(){this.game.state.start("menu")}};var menu=function(a){};menu.prototype={create:function(){this.stage.backgroundColor="#fbfaf7";var a=this.add.text(this.world.centerX-38,this.world.centerY-25,"Play",{font:"40px Arial",fill:"#747063"});a.inputEnabled=!0,a.input.useHandCursor=!0,a.events.onInputDown.add(function(){this.game.state.start("game")},this)}};var game=function(a){};game.prototype={init:function(a){this.universe=this.add.group(),this.surface={},this.player={},this.player_location=null,this.keyboard=!0},create:function(){this.stage.backgroundColor="#fbfaf7",this.data=this.cache.getJSON("data"),draw_surface(this),draw_cursor(this),draw_player(this),this.universe.x=this.world.centerX-this.surface_group.width,this.universe.y=this.world.centerY-50,this.input.keyboard.addCallbacks(this,null,function(){this.keyboard=!0})},update:function(){this.keyboard&&this.input.keyboard.isDown(Phaser.Keyboard.LEFT)&&(this.keyboard=!1,jump(this,"left")),this.keyboard&&this.input.keyboard.isDown(Phaser.Keyboard.RIGHT)&&(this.keyboard=!1,jump(this,"right")),this.keyboard&&this.input.keyboard.isDown(Phaser.Keyboard.UP)&&(this.keyboard=!1,jump(this,"up")),this.keyboard&&this.input.keyboard.isDown(Phaser.Keyboard.DOWN)&&(this.keyboard=!1,jump(this,"down"))}};var izojump=new Phaser.Game(1e3,800,Phaser.CANVAS,"game");izojump.state.add("preload",preload),izojump.state.add("menu",menu),izojump.state.add("game",game),izojump.state.start("preload");